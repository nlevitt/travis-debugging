---
- hosts: warcprox
  tasks:
  - shell: 'env | sort'
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - shell: which python3.4
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - shell: which pip
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - shell: which pip3
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - shell: which virtualenv
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - shell: pip --version
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - shell: pip3 --version
    register: out
  - debug: msg="{{out.stdout_lines}}"
  # - debug: msg="{{out.stderr_lines}}"

  - pip: name=git+https://github.com/internetarchive/warcprox.git#egg=warcprox
         virtualenv=/tmp/ansible-venv
         virtualenv_python=python3.4
         extra_args='--no-input --upgrade --pre --cache-dir=/tmp/pip-cache'

